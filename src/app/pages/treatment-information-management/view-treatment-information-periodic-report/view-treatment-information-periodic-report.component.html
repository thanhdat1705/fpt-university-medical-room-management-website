<div class="inner-content" *ngIf="treatmentTableData">
    <div class="d-flex flex-column ">
        <div class="filter">
            <span class="label">NV: </span>
            <nz-date-picker [ngClass]="{'border-selected': dateSelected}" nzMode="month" nzPlaceHolder="Tháng - Năm"
                nzFormat="MM-yyyy" [(ngModel)]="dateSelect" (ngModelChange)="onDateChange($event)"
                style="width: 250px;">
            </nz-date-picker>
        </div>
    </div>

    <nz-table class="medicine-table" #colSpanTable [nzData]="treatmentList" nzTableLayout="fixed" nzBordered
        [nzFrontPagination]="false" 
      (nzQueryParams)="onQueryParamsChange($event)" [nzLoading]="loading">
        <thead>
            <tr>
                <th nzWidth="10%" nzColumnKey="InternalCode">Ngày</th>
                <th nzWidth="5%" nzColumnKey="DisplayName">Stt</th>
                <th nzWidth="10%" nzColumnKey="Active">Tên nhân viên</th>
                <th nzWidth="8%" nzColumnKey="Active">Giới tính</th>
                <th nzWidth="10%" nzColumnKey="Active">Bộ phận</th>
                <th nzWidth="15%" nzColumnKey="Active">Tình trạng bệnh</th>
                <th nzWidth="20%" nzColumnKey="Active">Hướng điều trị</th>
                <th nzWidth="15%" nzColumnKey="Active">Số thuốc cấp</th>
                <th nzWidth="10%" nzColumnKey="Active">Kí nhận</th>

                <!-- <th nzWidth="10%"></th> -->
            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let data of treatmentTableData">
                <tr>
                    <td [attr.rowspan]="data.treatmentReportInfo.length + 1">{{data.date}}</td>
                </tr>
                <tr *ngFor="let treatment of data.treatmentReportInfo; index as i">

                    <td>{{ i+1 }}</td>
                    <td>{{ treatment.patientName }}</td>
                    <td>{{ getGender(treatment.patientGender) }}</td>
                    <td>{{ treatment.departmentName }}</td>
                    <td>{{ treatment.diseaseStatusName }}</td>
                    <td>{{ treatment.treatmentDirection }}</td>
                    <td>{{ treatment.numberOfMedicine }}</td>

                    <td *ngIf="treatment.confirmSignature == null; else confirmed">Chưa xác nhận</td>
                    <ng-template #confirmed>
                        <td>Đã xác nhận</td>
                    </ng-template>
                </tr>
            </ng-container>
         
        </tbody>
    </nz-table>
    <div class="d-flex flex-row align-items-center justify-content-between" style="width: 280px;">
        <a style="width: 130px;" nz-button nzType="primary" nzBlock nzSize="large" (click)="exportExcel()">
            <span>Xuất file Excel</span>
        </a>
    </div>
</div>